<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nonni's Word Game!</title>
    <style>
        /* --- GRANDMA AMENABLE ITALIAN PALETTE --- */
        :root {
            --ita-green: #2D5A27;    /* Deep Forest Green */
            --ita-ivory: #F9F7F2;    /* Warm Parchment */
            --ita-red: #A63D33;      /* Terracotta Red */
            --ita-gold: #D4AF37;     /* Subtle Gold Accent */
            --text-dark: #2C2C2C;    /* Soft Black */
            --border-color: #D1C7B7; /* Aged Paper Edge */
            
            /* Classic Serif Typography */
            --font-main: 'Georgia', serif;
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            background-color: #E8E2D6; /* Warm tabletop color */
            background-image: radial-gradient(#d1c7b7 1px, transparent 1px);
            background-size: 20px 20px;
            color: var(--text-dark);
            font-family: var(--font-main);
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
            padding: 2rem;
        }

        /* --- HEADER --- */
        header {
            text-align: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            width: 100%;
            max-width: 650px;
            border-bottom: 3px double var(--ita-green);
        }

        h1 {
            font-size: 3rem;
            font-style: italic;
            letter-spacing: 1px;
            margin-bottom: 5px;
        }

        .italy-text span:nth-child(1) { color: var(--ita-green); }
        .italy-text span:nth-child(2) { color: #555; } /* Greyish for the white part of flag */
        .italy-text span:nth-child(3) { color: var(--ita-red); }

        /* --- GAME CONTAINER --- */
        .game-container {
            background-color: var(--ita-ivory);
            padding: 3rem;
            border-radius: 4px;
            box-shadow: 5px 5px 15px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 650px;
            border: 1px solid var(--border-color);
            text-align: center;
            position: relative;
        }

        /* Decoratve Corner */
        .game-container::before {
            content: "‚ù¶";
            position: absolute;
            top: 10px;
            right: 15px;
            color: var(--ita-gold);
            font-size: 1.5rem;
        }

        /* --- SCORE BOARD --- */
        .score-board {
            display: flex;
            justify-content: space-around;
            font-size: 1.1rem;
            margin-bottom: 2rem;
            padding: 10px;
            border: 1px solid var(--ita-green);
            background: #fff;
            font-weight: bold;
        }

        /* --- LETTER TILES --- */
        .base-word-display {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-bottom: 2.5rem;
            flex-wrap: wrap;
        }

        .tile {
            background: white;
            border: 1px solid #999;
            color: var(--text-dark);
            width: 50px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.8rem;
            font-weight: bold;
            box-shadow: 2px 2px 0px rgba(0,0,0,0.1);
            border-bottom: 3px solid #777;
        }

        /* --- INPUT AREA --- */
        .input-area {
            display: flex;
            gap: 0;
            margin-bottom: 1.5rem;
            justify-content: center;
        }

        input[type="text"] {
            width: 60%;
            background: white;
            border: 1px solid var(--border-color);
            color: var(--text-dark);
            font-family: var(--font-main);
            font-size: 1.3rem;
            padding: 12px;
            outline: none;
            text-transform: uppercase;
        }

        button {
            background: var(--ita-green);
            border: none;
            color: white;
            padding: 12px 25px;
            font-family: var(--font-main);
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            transition: background 0.2s;
        }

        button:hover {
            background: #1e3d1a;
        }

        button#reset-btn {
            background: transparent;
            border: 1px solid var(--ita-red);
            color: var(--ita-red);
            margin-top: 20px;
            font-size: 0.9rem;
        }

        button#reset-btn:hover {
            background: var(--ita-red);
            color: white;
        }

        /* --- MESSAGES & LIST --- */
        .message {
            height: 24px;
            margin-bottom: 1rem;
            font-size: 1rem;
            font-weight: bold;
        }

        .msg-error { color: var(--ita-red); }
        .msg-success { color: var(--ita-green); }

        .found-words {
            text-align: left;
            margin-top: 2rem;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }

        .found-words h3 {
            font-size: 1rem;
            color: #666;
            margin-bottom: 1rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .word-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .found-tag {
            background: #f0ede6;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.9rem;
            border: 1px solid var(--border-color);
            font-style: italic;
        }

        .loader {
            display: none;
            font-style: italic;
            color: #888;
            margin-bottom: 10px;
        }
        .loader.active { display: block; }

    </style>
</head>
<body>

    <header>
        <h1 class="italy-text">
            <span>Nonni's</span><span> Word</span><span> Game</span>
        </h1>
        
    </header>

    <div class="game-container">
        <div class="score-board">
            <span>POINTS: <span id="score">0</span></span>
            <span>WORDS: <span id="word-count">0</span></span>
        </div>

        <div class="base-word-display" id="tile-container">
            </div>

        <div class="message" id="message-area"></div>
        <div class="loader" id="loader">Checking Dictionary...</div>

        <div class="input-area">
            <input type="text" id="user-input" placeholder="TYPE HERE..." autocomplete="off">
            <button id="submit-btn">ENTER</button>
        </div>

        <div class="found-words">
            <h3>DISCOVERED:</h3>
            <div class="word-list" id="found-list">
                </div>
        </div>

        <button id="reset-btn">NEW WORD</button>
    </div>

    <script>
        // --- CONFIGURATION ---
        // A list of "Base" words to start the game. 
        // These are guaranteed to be long enough to form other words.
        const SOURCE_WORDS2 = [
            "EDUCATION", "DISCOVERY", "ABSOLUTE", "PLATFORM", 
            "QUESTION", "LANGUAGE", "PROJECTS", "MATERIAL", 
            "SECURITY", "MOUNTAIN", "PAINTING", "REACTION", 
            "ARGUMENT", "CALENDAR", "DISTANCE", "QUARTER",
            "SPAGHETTI", "MACARONI", "ESPRESSO", "BROCCOLI"
            	
            // A little Italian flavor
        ];
        const SOURCE_WORDS = [
            "EDUCATION", "DISCOVERY", "ABSOLUTE", "PLATFORM", 
            "QUESTION", "LANGUAGE", "PROJECTS", "MATERIAL", 
            "SECURITY", "MOUNTAIN", "PAINTING", "REACTION", 
            "ARGUMENT", "CALENDAR", "DISTANCE", "QUARTER",
            "SPAGHETTI", "MACARONI", "ESPRESSO", "BROCCOLI",
            "Ability","Backing","Cabinet","Absence","Balance","Calibre","Academy","Banking","Calling","Account","Barrier","Capable","Accused","Battery","Capital","Achieve","Bearing","Captain","Acquire","Beating","Caption","Address","Because","Capture","Advance","Bedroom","Careful","Adverse","Believe","Carrier","Advised","Beneath","Caution","Adviser","Benefit","Ceiling","Against","Besides","Central","Airline","Between","Centric","Airport","Billion","Century","Alcohol","Binding","Certain","Alleged","Brother","Chamber","Already","Brought","Channel","Analyst","Burning","Chapter","Ancient","Dealing","Charity","Another","Decided","Charlie","Anxiety","Decline","Charter","Anxious","Default","Checked","Anybody","Defence","Chicken","Applied","Deficit","Chronic","Arrange","Deliver","Circuit","Arrival","Density","Classes","Article","Deposit","Classic","Assault","Desktop","Climate","Assumed","Despite","Closing","Assured","Destroy","Closure","Attempt","Develop","Clothes","Attract","Devoted","Collect","Auction","Diamond","College","Average","Digital","Combine","Eastern","Discuss","Economy","Disease","Command","Edition","Display","Comment","Elderly","Dispute","Compact","Element","Distant","Company","Engaged","Diverse","Compare","Enhance","Divided","Compete","Essence","Drawing","Complex","Evening","Driving","Concept","Evident","Dynamic","Concern","Exactly","Factory","Concert","Examine","Faculty","Conduct","Example","Failing","Confirm","Excited","Failure","Connect","Exclude","Fashion","Consent","Exhibit","Feature","Consist","Expense","Federal","Contact","Explain","Feeling","Contain","Explore","Fiction","Content","Express","Fifteen","Contest","Extreme","Filling","Context","Gallery","Finance","Control","Gateway","Finding","Convert","General","Fishing","Correct","Genetic","Fitness","Council","Genuine","Foreign","Counsel","Gigabit","Forever","Counter","Greater","Formula","Country","Hanging","Fortune","Crucial","Heading","Forward","Crystal","Healthy","Founder","Culture","Hearing","Freedom","Current","Heavily","Further","Cutting","Helpful","Illegal","Jointly","Helping","Illness","Journal","Herself","Imagine","Journey","Highway","Imaging","Justice","Himself","Improve","Justify","History","Include","Keeping","Holding","Initial","Killing","Holiday","Inquiry","Kingdom","Housing","Insight","Kitchen","However","Install","Knowing","Hundred","Instant","Machine","Husband","Instead","Manager","Landing","Intense","Married","Largely","Interim","Massive","Lasting","Involve","Maximum","Leading","Natural","Meaning","Learned","Neither","Measure","Leisure","Nervous","Medical","Liberal","Network","Meeting","Liberty","Neutral","Mention","Library","Notable","Message","License","Nothing","Million","Limited","Nowhere","Mineral","Listing","Nuclear","Minimal","Logical","Nursing","Minimum","Loyalty","Pacific","Missing","Obvious","Package","Mission","Offence","Painted","Mistake","Officer","Parking","Mixture","Ongoing","Partial","Monitor","Opening","Partner","Monthly","Operate","Passage","Morning","Opinion","Passing","Musical","Optical","Passion","Mystery","Organic","Passive","Portion","Outcome","Patient","Poverty","Outdoor","Pattern","Precise","Outlook","Payable","Predict","Outside","Payment","Premier","Overall","Penalty","Premium","Proudly","Pending","Prepare","Project","Pension","Present","Promise","Pealing","Prevent","Promote","Perfect","Primary","Protect","Perform","Printer","Protein","Perhaps","Privacy","Protest","Phoenix","Private","Provide","Picking","Problem","Publish","Picture","Proceed","Purpose","Pioneer","Process","Pushing","Plastic","Produce","Qualify","Pointed","Product","Quality","Popular","Profile","Quarter","Section","Success","Radical","Segment","Suggest","Railway","Serious","Summary","Readily","Service","Support","Reading","Serving","Suppose","Reality","Session","Supreme","Realise","Setting","Surface","Receipt","Seventh","Surgery","Receive","Several","Surplus","Recover","Shortly","Survive","Reflect","Showing","Suspect","Regular","Silence","Sustain","Related","Silicon","Teacher","Release","Similar","Telecom","Remains","Sitting","Telling","Removal","Sixteen","Tension","Removed","Skilled","Theatre","Replace","Smoking","Therapy","Request","Society","Thereby","Require","Somehow","Thought","Reserve","SomeoneThrough","Resolve","Speaker","Tonight","Respect","Special","Totally","Respond","Species","Touched","Restore","Sponsor","Towards","Retired","Station","Traffic","Revenue","Storage","Trouble","Reverse","Strange","Turning","Rollout","Stretch","Typical","Routine","Student","Uniform","Running","Studied","Unknown","Satisfy","Subject","Unusual","Science","Succeed","Upgrade","Walking","Whether","Upscale","Wanting","Willing","Utility","Warning","Winning","Variety","Warrant","Without","Various","Wearing","Witness","Vehicle","Weather","Working","Venture","Webcast","Writing","Version","Website","Written","Veteran","Wedding","Western","Victory","Weekend","Whereas","Viewing","Welcome","Whereby","Village","Welfare","Virtual","Violent","Visible","Waiting"
        ];

        // --- STATE ---
        let currentBaseWord = "";
        let foundWords = new Set();
        let score = 0;

        // --- DOM ELEMENTS ---
        const tileContainer = document.getElementById('tile-container');
        const inputField = document.getElementById('user-input');
        const submitBtn = document.getElementById('submit-btn');
        const resetBtn = document.getElementById('reset-btn');
        const messageArea = document.getElementById('message-area');
        const scoreDisplay = document.getElementById('score');
        const countDisplay = document.getElementById('word-count');
        const foundList = document.getElementById('found-list');
        const loader = document.getElementById('loader');

        // --- INITIALIZATION ---
        function initGame() {
            // Pick random word
            const randomIndex = Math.floor(Math.random() * SOURCE_WORDS.length);
            currentBaseWord = SOURCE_WORDS[randomIndex];
            
            // Reset State
            foundWords.clear();
            score = 0;
            updateScoreBoard();
            
            // Clear UI
            foundList.innerHTML = '';
            inputField.value = '';
            messageArea.textContent = '';
            messageArea.className = 'message';
            
            // Render Tiles
            renderTiles(currentBaseWord);
        }

        // --- RENDER FUNCTIONS ---
        function renderTiles(word) {
            tileContainer.innerHTML = '';
            // Shuffle letters visually for the user (optional, but makes it a game)
            const letters = word.toUpperCase().split('');//.sort(() => Math.random() - 0.5);
            
            letters.forEach(char => {
                const tile = document.createElement('div');
                tile.classList.add('tile');
                tile.textContent = char;
                tileContainer.appendChild(tile);
            });
        }

        function updateScoreBoard() {
            scoreDisplay.textContent = score;
            countDisplay.textContent = foundWords.size;
        }

        function addWordToHistory(word) {
            const tag = document.createElement('div');
            tag.classList.add('found-tag');
            tag.textContent = word;
            foundList.prepend(tag); // Add new words to the top
        }

        function showMessage(msg, type) {
            messageArea.textContent = msg;
            messageArea.className = `message msg-${type}`;
            // Clear error messages after 2 seconds
            if(type === 'error') {
                setTimeout(() => {
                    if(messageArea.textContent === msg) {
                        messageArea.textContent = '';
                    }
                }, 2000);
            }
        }

        // --- LOGIC HELPER ---
        // Checks if 'testWord' can be formed using letters from 'sourceWord'
        function canFormWord(testWord, sourceWord) {
            const sourceMap = {};
            // Count frequency of source letters
            for (let char of sourceWord) {
                sourceMap[char] = (sourceMap[char] || 0) + 1;
            }

            // Check if testWord uses only available letters
            for (let char of testWord) {
                if (!sourceMap[char]) return false;
                sourceMap[char]--;
            }
            return true;
        }

        // --- API VALIDATION ---
        async function isValidDictionaryWord(word) {
            try {
                // Using free Dictionary API
                const response = await fetch(`https://api.dictionaryapi.dev/api/v2/entries/en/${word}`);
                if (!response.ok) return false;
                const data = await response.json();
                // If API returns a title "No Definitions Found", it's invalid
                return !data.title; 
            } catch (err) {
                console.error("API Error", err);
                return false; // Fail safe
            }
        }

        // --- GAMEPLAY HANDLER ---
        async function handleSubmission() {
            const guess = inputField.value.trim().toUpperCase();

            // 1. Basic Validation
            if (!guess) return;
            if (guess.length < 3) {
                showMessage("Too short! (3+ letters)", "error");
                return;
            }
            if (foundWords.has(guess)) {
                showMessage("Already found!", "error");
                inputField.value = '';
                return;
            }

            // 2. Letter Check (Client Side - Fast)
            if (!canFormWord(guess, currentBaseWord)) {
                showMessage("Missing letters!", "error");
                // Shake animation logic could go here
                return;
            }

            // 3. Dictionary Check (Server Side - Async)
            loader.classList.add('active');
            submitBtn.disabled = true;
            
            const isValid = await isValidDictionaryWord(guess);
            
            loader.classList.remove('active');
            submitBtn.disabled = false;
            inputField.focus();

            if (isValid) {
                // Success
                foundWords.add(guess);
                score++;
                updateScoreBoard();
                addWordToHistory(guess);
                showMessage("Benissimo! +1 Point", "success");
                inputField.value = '';
            } else {
                showMessage("Not a valid dictionary word.", "error");
            }
        }

        // --- EVENT LISTENERS ---
        submitBtn.addEventListener('click', handleSubmission);

        inputField.addEventListener('keypress', (e) => {
            if (e.key === 'Enter') handleSubmission();
        });

        resetBtn.addEventListener('click', () => {
            initGame();
        });

        // Start the game on load
        initGame();

    </script>
</body>
</html>
